---
// estagio_gestao_documental/frontend/src/pages/admin/roles.astro
import Layout from "@layouts/Layout.astro";
import RoleList from "@components/admin/RoleList.svelte"; // Import the list component
---

<Layout title="Gerir Funções">
    <div class="flex justify-between items-center mb-4">
        <h1 class="text-2xl font-bold">Gerir Funções</h1>
        <div>
            <button id="create-role-button" class="btn btn-primary mr-2">
                <i class="fa-solid fa-plus mr-2"></i> Criar Função
            </button>
            <a href="/admin/" class="btn btn-sm btn-ghost">
                <i class="fa-solid fa-arrow-left mr-2"></i> Voltar
            </a>
        </div>
    </div>
    <div
        class="bg-base-100 rounded-lg shadow-md border border-base-content/10 overflow-hidden p-4"
    >
        <RoleList client:load />
    </div>
</Layout>

<script>
    // Script to trigger the modal opening from the Astro page button
    document.addEventListener("astro:page-load", () => {
        if (window.location.pathname !== "/admin/roles/") return;

        const createButton = document.getElementById("create-role-button");
        // The RoleList component needs to expose a function globally or via custom events.
        // Using a simple global function for now, refine if needed.
        createButton?.addEventListener("click", () => {
            // Assuming RoleList exposes openCreateModal globally
            if (window.openCreateRoleModal) {
                window.openCreateRoleModal();
            } else {
                console.error(
                    "openCreateRoleModal function not found on window.",
                );
            }
        });
    });
</script>
